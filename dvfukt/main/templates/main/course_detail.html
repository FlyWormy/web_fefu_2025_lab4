{% extends 'main/base.html' %}
{% load static %}

{% block title %}{{ course.title }}{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">
    <div style="background: #e9ecef; padding: 25px; border-radius: 10px; margin-bottom: 20px;">
        <h1>{{ course.title }}</h1>
        <p style="font-size: 1.2em; color: #6c757d;">
            –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: {{ course.instructor.full_name }}
        </p>
    </div>

    <div style="background: white; padding: 25px; border-radius: 8px; border: 1px solid #dee2e6;">
        <h3>–û–ø–∏—Å–∞–Ω–∏–µ –∫—É—Ä—Å–∞</h3>
        <p style="white-space: pre-line;">{{ course.description }}</p>

        <div style="margin-top: 30px;">
            <h4>üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—É—Ä—Å–µ</h4>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                <div>
                    <strong>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong><br>
                    {{ course.duration_hours }} —á–∞—Å–æ–≤
                </div>
                <div>
                    <strong>–°—Ç–∞—Ç—É—Å:</strong><br>
                    <span style="color: {% if course.is_active %}#28a745{% else %}#dc3545{% endif %};">
                        {{ course.is_active|yesno:"–ê–∫—Ç–∏–≤–µ–Ω,–ù–µ –∞–∫—Ç–∏–≤–µ–Ω" }}
                    </span>
                </div>
                <div>
                    <strong>–°–æ–∑–¥–∞–Ω:</strong><br>
                    {{ course.created_at|date:"d.m.Y" }}
                </div>
                <div>
                    <strong>–ó–∞–ø–∏—Å–µ–π –Ω–∞ –∫—É—Ä—Å:</strong><br>
                    {{ enrollments|length }} —Å—Ç—É–¥–µ–Ω—Ç{{ enrollments|length|pluralize:"–æ–≤" }}
                </div>
            </div>
        </div>

        {% if enrollments %}
        <div style="margin-top: 40px;">
            <h4>üë®‚Äçüéì –°—Ç—É–¥–µ–Ω—Ç—ã –∫—É—Ä—Å–∞</h4>
            <div style="margin-top: 15px;">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #f8f9fa;">
                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">–°—Ç—É–¥–µ–Ω—Ç</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">–°—Ç–∞—Ç—É—Å</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">–î–∞—Ç–∞ –∑–∞–ø–∏—Å–∏</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for enrollment in enrollments %}
                        <tr style="border-bottom: 1px solid #dee2e6;">
                            <td style="padding: 10px;">
                                <a href="{% url 'student_profile' enrollment.student.student_profile.id %}" style="text-decoration: none; color: #007bff;">
                                    {{ enrollment.student.student_profile.get_full_name }}
                                </a>
                            </td>
                            <td style="padding: 10px;">
                                <span style="color: {% if enrollment.status == 'active' %}#28a745{% elif enrollment.status == 'completed' %}#007bff{% else %}#dc3545{% endif %};">
                                    {{ enrollment.get_status_display }}
                                </span>
                            </td>
                            <td style="padding: 10px;">
                                {{ enrollment.enrollment_date|date:"d.m.Y" }}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}
    </div>

    <div style="margin-top: 30px; display: flex; gap: 15px;">
        <a href="{% url 'course_list' %}" class="btn btn-secondary">
            ‚Üê –í—Å–µ –∫—É—Ä—Å—ã
        </a>
        <a href="{% url 'index' %}" class="btn btn-secondary">
            –ù–∞ –≥–ª–∞–≤–Ω—É—é
        </a>
        {% if user.is_authenticated and not user_enrolled %}
            {% if user.student_profile.is_student %}
                <a href="{% url 'enrollment_current' %}" class="btn">
                    üìù –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å
                </a>
            {% endif %}
        {% endif %}
    </div>
</div>
{% endblock %}